<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Restaurant | Table Booking</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet" />

  <style>
    :root{
      --primary:#fb923c;
      --success:#22c55e;
      --danger:#ef4444;
      --bg:#020617;
      --surface:rgba(15,23,42,.95);
      --glass:rgba(15,23,42,.92);
      --border:rgba(31,41,55,.8);
      --muted:#9ca3af;
      --text:#e5e7eb;
    }

    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
    }

    body{
      font-family:"Poppins",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.6;
    }

    /* HEADER */
    header{
      background:
        radial-gradient(circle at top left,rgba(251,146,60,.3),transparent 55%),
        radial-gradient(circle at bottom right,rgba(34,197,94,.25),transparent 55%),
        linear-gradient(rgba(15,23,42,.85),rgba(15,23,42,.92)),
        url("images/restaurant.jpg") center/cover no-repeat fixed;
      color:#fef3c7;
      text-align:center;
      padding:80px 20px 70px;
      position:relative;
    }

    header::before{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(135deg,rgba(239,68,68,.15),rgba(251,146,60,.12));
      pointer-events:none;
    }

    .header-inner{
      position:relative;
      max-width:500px;
      margin:auto;
    }

    header h1{
      margin:0;
      font-size:32px;
      font-weight:600;
      letter-spacing:.02em;
    }

    header p{
      margin-top:8px;
      font-size:15px;
      opacity:.95;
      color:#e5e7eb;
    }

    /* CONTAINER */
    .container{
      max-width:420px;
      margin:-50px auto 0;
      padding:20px 16px 40px;
      position:relative;
      z-index:1;
    }

    /* CARD */
    .card{
      background:var(--glass);
      backdrop-filter:blur(20px);
      border-radius:24px;
      padding:32px 28px;
      box-shadow:0 32px 80px rgba(0,0,0,.75);
      border:1px solid var(--border);
      position:relative;
      overflow:hidden;
    }

    .card::before{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(135deg,rgba(251,146,60,.08),rgba(34,197,94,.06));
      pointer-events:none;
    }

    .card-inner{
      position:relative;
    }

    .step-indicator{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      margin-bottom:24px;
      font-size:12px;
      color:var(--muted);
    }

    .step-dot{
      width:6px;
      height:6px;
      border-radius:50%;
      background:var(--primary);
      box-shadow:0 0 12px rgba(251,146,60,.6);
    }

    /* INPUTS */
    .form-group{
      margin-bottom:20px;
    }

    label{
      font-size:13px;
      font-weight:500;
      color:var(--text);
      margin-bottom:6px;
      display:block;
      letter-spacing:.02em;
    }

    .input-wrapper{
      position:relative;
    }

    input{
      width:100%;
      padding:14px 16px;
      background:rgba(15,23,42,.7);
      border:1px solid var(--border);
      border-radius:14px;
      font-size:15px;
      color:var(--text);
      transition:.2s ease;
      backdrop-filter:blur(8px);
    }

    input::placeholder{
      color:var(--muted);
    }

    input:focus{
      outline:none;
      border-color:var(--primary);
      box-shadow:0 0 0 3px rgba(251,146,60,.15);
      background:rgba(15,23,42,.9);
    }

    .input-icon{
      position:absolute;
      right:14px;
      top:50%;
      transform:translateY(-50%);
      font-size:16px;
      color:var(--muted);
      pointer-events:none;
    }

    /* BUTTON */
    .btn{
      width:100%;
      margin-top:24px;
      padding:16px;
      background:linear-gradient(135deg,var(--success),#16a34a);
      color:#fff;
      border:none;
      border-radius:16px;
      font-size:16px;
      font-weight:500;
      cursor:pointer;
      transition:.2s ease;
      box-shadow:0 16px 40px rgba(34,197,94,.5);
      position:relative;
      overflow:hidden;
    }

    .btn:hover{
      transform:translateY(-1px);
      box-shadow:0 24px 55px rgba(34,197,94,.7);
    }

    .btn:active{
      transform:translateY(0);
    }

    /* NOTE */
    .note{
      background:rgba(239,68,68,.15);
      border-left:4px solid var(--danger);
      padding:16px;
      margin-top:20px;
      font-size:13px;
      color:#fca5a5;
      border-radius:12px;
      backdrop-filter:blur(8px);
    }

    .note strong{
      color:#fee2e2;
      font-weight:600;
    }

    /* BACK */
    .back{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin:32px 0 0;
      color:var(--muted);
      text-decoration:none;
      font-size:14px;
      justify-content:center;
    }

    .back:hover{
      color:var(--text);
    }

    /* VALIDATION */
    .error{
      border-color:var(--danger) !important;
      box-shadow:0 0 0 3px rgba(239,68,68,.2) !important;
    }

    .error-message{
      color:var(--danger);
      font-size:12px;
      margin-top:4px;
      display:none;
    }

    /* RESPONSIVE */
    @media(max-width:480px){
      .container{
        margin-top:-40px;
        padding:16px;
      }
      
      .card{
        padding:24px 20px;
      }
      
      header h1{
        font-size:28px;
      }
    }
  </style>
</head>

<body>

<header>
  <div class="header-inner">
    <h1>üçΩ Table Reservation</h1>
    <p>Secure your table in just 30 seconds</p>
  </div>
</header>

<div class="container">
  <div class="card">
    <div class="card-inner">
      
      <div class="step-indicator">
        <span class="step-dot"></span>
        Fill details ‚Ä¢ Confirm ‚Ä¢ Pay ‚Çπ200
      </div>

      <div class="form-group">
        <label for="name">Full Name</label>
        <div class="input-wrapper">
          <input id="name" placeholder="Enter your full name" />
          <span class="input-icon">üë§</span>
        </div>
        <div class="error-message" id="name-error">Please enter your name</div>
      </div>

      <div class="form-group">
        <label for="mobile">Mobile Number</label>
        <div class="input-wrapper">
          <input id="mobile" placeholder="10-digit mobile number" maxlength="10" />
          <span class="input-icon">üì±</span>
        </div>
        <div class="error-message" id="mobile-error">Enter valid 10-digit mobile number</div>
      </div>

      <div class="form-group">
        <label for="date">Date</label>
        <div class="input-wrapper">
          <input type="date" id="date" />
          <span class="input-icon">üìÖ</span>
        </div>
        <div class="error-message" id="date-error">Please select date</div>
      </div>

      <div class="form-group">
        <label for="time">Time</label>
        <div class="input-wrapper">
          <input type="time" id="time" />
          <span class="input-icon">üïí</span>
        </div>
        <div class="error-message" id="time-error">Please select time</div>
      </div>

      <div class="form-group">
        <label for="guests">Number of Guests</label>
        <div class="input-wrapper">
          <input type="number" id="guests" min="1" max="12" placeholder="1-12 guests" />
          <span class="input-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
        </div>
        <div class="error-message" id="guests-error">Enter number of guests (1-12)</div>
      </div>

      <button class="btn" onclick="bookTable()">
        Confirm Booking & Pay ‚Çπ200
      </button>

      <div class="note">
        <strong>‚Çπ200 reservation fee</strong> applies.<br>
        This amount will be <strong>adjusted in your final bill</strong>.
      </div>

    </div>
  </div>

  <a href="restaurant_home.html" class="back">‚¨Ö Back to Restaurant</a>
</div>

<script>
function showError(id, message) {
  const input = document.getElementById(id);
  const errorEl = document.getElementById(id + '-error');
  
  input.classList.add('error');
  errorEl.textContent = message;
  errorEl.style.display = 'block';
}

function clearError(id) {
  const input = document.getElementById(id);
  const errorEl = document.getElementById(id + '-error');
  
  input.classList.remove('error');
  errorEl.style.display = 'none';
}

function bookTable(){
    const name = document.getElementById("name").value.trim();
    const mobile = document.getElementById("mobile").value.trim();
    const date = document.getElementById("date").value;
    const time = document.getElementById("time").value;
    const guests = document.getElementById("guests").value;

    // Clear previous errors
    clearError('name');
    clearError('mobile');
    clearError('date');
    clearError('time');
    clearError('guests');

    let valid = true;

    if(!name){
        showError('name', 'Please enter your name');
        valid = false;
    }

    if(!mobile || mobile.length !== 10 || isNaN(mobile)){
        showError('mobile', 'Enter valid 10-digit mobile number');
        valid = false;
    }

    if(!date){
        showError('date', 'Please select date');
        valid = false;
    }

    if(!time){
        showError('time', 'Please select time');
        valid = false;
    }

    if(!guests || guests < 1 || guests > 12){
        showError('guests', 'Enter number of guests (1-12)');
        valid = false;
    }

    if(!valid) return;

    const details = `Table for ${guests} on ${date} at ${time} (Name: ${name}, Mobile: ${mobile})`;

    fetch("http://127.0.0.1:10000/api/bookings",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({
            service:"Restaurant Table Booking",
            details:details,
            amount:200
        })
    })
    .then(res=>res.json())
    .then(data=>{
        if(data.booking_id){
            localStorage.setItem("booking_id", data.booking_id);
            window.location.href = "payment.html?id=" + data.booking_id;
        }else{
            alert("Booking failed");
        }
    })
    .catch(()=>{
        alert("Backend not running");
    });
}
</script>

</body>
</html>
